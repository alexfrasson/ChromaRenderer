package(default_visibility = ["//visibility:public"])

config_setting(
    name = "on_linux",
    constraint_values = [
        "@platforms//os:linux",
    ],
)

config_setting(
    name = "on_windows",
    constraint_values = [
        "@platforms//os:windows",
    ],
)

cc_library(
    name = "cuda_headers",
    hdrs = glob(
        include = [
            "include/**/*.h",
            "include/**/*.hpp",
        ],
        #allow_empty = False,
    ),
    includes = ["include"],
)

cc_library(
    name = "cuda",
    srcs = select({
        ":on_linux": [],
        ":on_windows": ["lib/x64/cuda.lib"],
    }),
    #linkopts = ["-ldl"],
)

cc_library(
    name = "cuda_runtime",
    srcs = select({
        ":on_linux": ["lib64/libcudart_static.a"],
        ":on_windows": ["lib/x64/cudart_static.lib"],
    }),
    linkopts = [
        "-lpthread",
        "-lrt",
    ],
    deps = [":cuda"],
)

cc_library(
    name = "curand_static",
    srcs = ["lib/x64/curand.lib"],
    deps = [
        #":culibos",
    ],
)

filegroup(
    name = "nvcc",
    srcs = select({
        ":on_linux": ["bin/nvcc"],
        ":on_windows": ["bin/nvcc.exe"],
    }),
)
